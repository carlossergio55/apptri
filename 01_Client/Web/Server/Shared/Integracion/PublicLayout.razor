@inherits LayoutComponentBase
@using MudBlazor
@using Microsoft.AspNetCore.Components
@inject NavigationManager Nav
@inject IDialogService Dialog
@inject IJSRuntime JS
@using Server.Shared.Integracion
<HeadContent>
  <link href="styles/Integracion/modal-destinos.css" rel="stylesheet" />
  <link href="styles/Integracion/inicio.css" rel="stylesheet" />
  <link href="styles/Integracion/comprar-public.css" rel="stylesheet" />
    <link href="~/styles/Integracion/aviso_dialog.css" rel="stylesheet" asp-append-version="true" />
</HeadContent>

<MudLayout>

  <!-- Barra de navegación -->
  <MudAppBar Elevation="4" Color="Color.Primary" Fixed="true" Class="barra-navegacion">
    <MudContainer Class="barra-navegacion-contenido px-4">
      <div class="navegacion-logo">
        <MudButton Variant="Variant.Text" Class="boton-logo" Style="text-transform: none; padding: 0;" OnClick="@(() => Nav.NavigateTo("/inicio"))">
          <div class="d-flex align-items-center">
            <MudImage Src="images/logo_sin.png" Alt="Logo" Class="logo-img" />
            <div class="texto-logo ms-2">
              <div class="linea1">TRANS</div>
              <div class="linea2">INTEGRACIÓN</div>
              <div class="parachoque"></div>
            </div>
          </div>
        </MudButton>
      </div>

      <div class="navegacion-derecha">
        <MudHidden Breakpoint="Breakpoint.MdAndUp">
          <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" OnClick="@ToggleDrawer" Edge="Edge.End" Class="hamburguesa-btn" />
        </MudHidden>

        <MudHidden Breakpoint="Breakpoint.MdAndDown">
          <div class="grupo_btn_nav d-flex gap-2">
            <div class="wrap_btn_nav"><MudButton Class="btn_nav" Variant="Variant.Text" Size="Size.Small" OnClick="@(() => Nav.NavigateTo("/comprar-public"))">Pasajes</MudButton></div>
            <div class="wrap_btn_nav"><MudButton Class="btn_nav" Variant="Variant.Text" Size="Size.Small" OnClick="@(() => Nav.NavigateTo("/rastreo"))">Carga y Encomienda</MudButton></div>
            <div class="wrap_btn_nav"><MudButton Class="btn_nav" Variant="Variant.Text" Size="Size.Small" OnClick="@(() => Nav.NavigateTo("/sucursales"))">Sucursales</MudButton></div>
            <div class="wrap_btn_nav"><MudButton Class="btn_nav" Variant="Variant.Text" Size="Size.Small" OnClick="@(() => Nav.NavigateTo("/nosotros"))">Nuestra Empresa</MudButton></div>
            <div class="wrap_btn_nav"><MudButton Class="btn_nav" Variant="Variant.Text" Size="Size.Small" OnClick="@(() => Nav.NavigateTo("/contactenos"))">Contáctenos</MudButton></div>
          </div>
        </MudHidden>
      </div>
    </MudContainer>
  </MudAppBar>

  @if (_drawerOpen)
  {
    <div class="mobile-menu-overlay" @onclick="CerrarDrawer">
      <div class="mobile-menu-paper" @onclick:stopPropagation="true">
        <div class="mobile-nav-menu" style="display: flex; flex-direction: column; gap: 12px;">
          <MudButton Class="mobile-nav-item" Variant="Variant.Text" OnClick="@(() => NavegarYCerrar("/comprar-public"))">Pasajes</MudButton>
          <MudButton Class="mobile-nav-item" Variant="Variant.Text" OnClick="@(() => NavegarYCerrar("/rastreo"))">Carga y Encomienda</MudButton>
          <MudButton Class="mobile-nav-item" Variant="Variant.Text" OnClick="@(() => NavegarYCerrar("/sucursales"))">Sucursales</MudButton>
          <MudButton Class="mobile-nav-item" Variant="Variant.Text" OnClick="@(() => NavegarYCerrar("/nosotros"))">Nuestra Empresa</MudButton>
          <MudButton Class="mobile-nav-item" Variant="Variant.Text" OnClick="@(() => NavegarYCerrar("/contactenos"))">Contáctenos</MudButton>
        </div>
      </div>
    </div>
  }



  <!-- Contenido principal -->
  <MudMainContent Class="p-0 contenido-ajustado">
    @Body
  </MudMainContent>

  <!-- Proveedores -->
  <MudDialogProvider />
  <MudSnackbarProvider Class="snackbar-ajustada"
                       Position="SnackbarPosition.TopCenter"
                       MaxDisplayedSnackbars="3"
                       PreventDuplicates="true" />
  <MudPopoverProvider />

    <!-- Footer -->
    <MudPaper Elevation="10" Class="footer-container">
        <MudContainer MaxWidth="MaxWidth.False" Class="footer-content">
            <MudGrid>
                <!-- DIRECCIÓN DEL SITIO -->
                <MudItem xs="12" sm="6" md="3">
                    <MudText Typo="Typo.h6" Class="footer-title">DIRECCIÓN DEL SITIO</MudText>
                    <MudList>
                        <MudListItem Href="/inicio" Text="Inicio" Class="footer-link" />
                        <MudListItem Href="/comprar-public" Text="Pasajes" Class="footer-link" />
                        <MudListItem Href="/rastreo" Text="Carga y Encomiendas" Class="footer-link" />
                        <MudListItem Href="/sucursales" Text="Sucursales" Class="footer-link" />
                        <MudListItem Href="/contacto" Text="Contáctenos" Class="footer-link" />
                    </MudList>
                </MudItem>

                <!-- INFORMACIÓN -->
                <MudItem xs="12" sm="6" md="3">
                    <MudText Typo="Typo.h6" Class="footer-title">INFORMACIÓN</MudText>
                    <MudList>
                        <MudListItem Text="Comprar Pasajes" Class="footer-link" />
                        <MudListItem Text="Rastrear Carga y Encomiendas" Class="footer-link" />
                        <MudListItem Text="Destinos" Class="footer-link" />
                        <MudListItem Text="Términos y Condiciones" Class="footer-link" />
                    </MudList>
                </MudItem>

                <!-- CONTÁCTENOS -->
                <MudItem xs="12" sm="6" md="3">
                    <MudText Typo="Typo.h6" Class="footer-title">CONTÁCTENOS</MudText>
                    <MudList>
                        <MudListItem Class="footer-contact-item">
                            <MudText Class="footer-contact-title">Atención al Cliente:</MudText>
                            <MudText Class="footer-contact-value">+591-71178739</MudText>
                        </MudListItem>

                        <MudListItem Class="footer-contact-item">
                            <MudText Class="footer-contact-title">Oficina Central:</MudText>
                            <MudText Class="footer-contact-value">18774744</MudText>
                        </MudListItem>
                        <MudListItem Class="footer-contact-item">
                            <MudText Class="footer-contact-title">Dirección:</MudText>
                            <MudText Class="footer-contact-value">Terminal Interprovincial - Sucre - Bolivia</MudText>
                        </MudListItem>
                        <MudListItem Class="footer-contact-item">
                            <MudText Class="footer-contact-title">Correo:</MudText>
                            <MudText Class="footer-contact-value">info@transintegracion.com</MudText>
                        </MudListItem>
                    </MudList>
                </MudItem>

                <!-- ACERCA DE NOSOTROS -->
                <MudItem xs="12" sm="6" md="3">
                    <MudText Typo="Typo.h6" Class="footer-title">ACERCA DE NOSOTROS</MudText>
                    <MudText Class="footer-about">
                        Somos una empresa boliviana con más de 34 años de experiencia en el transporte terrestre de pasajeros, carga y encomiendas.
                    </MudText>
                    <!-- redes sociales -->
                    <MudStack Direction="Row" Spacing="3" Class="mt-4 redes-footer">
                        <a href="https://www.facebook.com/share/1CFPSj6Twy/" target="_blank" rel="noopener noreferrer" class="text-primary">
                            <i class="fab fa-facebook fa-2x"></i>
                        </a>
                        <a href="https://www.instagram.com/erick_jhoel_castro?igsh=MWJ4ZXZvaGJhNDZteg==" target="_blank" rel="noopener noreferrer" class="text-primary">
                            <i class="fab fa-instagram fa-2x"></i>
                        </a>
                    </MudStack>


                </MudItem>
            </MudGrid>
        </MudContainer>
    </MudPaper>

    <!-- Pie de página (copyright) -->
    <MudPaper Class="copyright text-center p-4" Elevation="0">
        <MudText Typo="Typo.caption" Class="copyright-text">
            © 2025 Trans Integración | Todos los derechos reservados.
            <br />

            Desarrollado como proyecto de defensa de grado de la carrera de Ingeniería de Sistemas TIC – Universidad Boliviana de Informática (UBI).
        </MudText>
    </MudPaper>





</MudLayout>



@code {
  private bool _drawerOpen = false;

  void ToggleDrawer() { _drawerOpen = !_drawerOpen; StateHasChanged(); }
  void CerrarDrawer() { _drawerOpen = false; StateHasChanged(); }
  void NavegarYCerrar(string url) { _drawerOpen = false; StateHasChanged(); Nav.NavigateTo(url); }

  // ✅ Mostrar aviso 1 vez por día (MudBlazor MessageBox + localStorage)
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (!firstRender) return;

        var messageHtml =
            "⚠️ Por el momento, el sistema solo permite compras <b>desde Sucre</b> hacia sus diferentes destinos. " +
            "Próximamente habilitaremos compras desde todas nuestras sucursales. ¡Gracias por su comprensión!";

        var opts = new DialogOptions
        {
            MaxWidth = MaxWidth.Small,
            CloseOnEscapeKey = true,
            DisableBackdropClick = true
        };

        var p = new DialogParameters
        {
            ["Title"] = "Aviso",
            ["Message"] = messageHtml,
            ["RootClass"] = "aviso-modal",
            ["TitleClass"] = "aviso-titulo",
            ["ContentClass"] = "aviso-contenido",
            ["ActionsClass"] = "aviso-acciones",
            ["OkButtonClass"] = "aviso-btn-primario",
            ["OkText"] = "Entendido"
        };

        var dlg = Dialog.Show<Server.Shared.Integracion.AvisoDialog>(title: null, parameters: p, options: opts);
        await dlg.Result;

    }





}
